<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{/admin/inc/layout}"
>
  <head>
    <meta charset="UTF-8" />
    <title>Title</title>
  </head>
  <body>
    <main
      layout:fragment="main"
      class="n-panel n-main-panel d:flex flex-direction:column"
    >
      <form
        class="n-form md:n-field-label-position:left border:0 w:3/5 mx:auto my:10"
      >
        <div>
          <select class="border" name="searchMethod">
            <option th:selected="${param.searchMethod} == 'title'" value="title">제목</option>
            <option th:selected="${{param.searchMethod}} == 'description'" value="description">내용</option>
          </select>
          <input type="text" name="searchKeyword" placeholder="검색어를 입력하세요" th:value="${#strings.trim(param.searchKeyword)}"/>
          <button class="n-btn n-btn-type:outline-box">검색</button>
        </div>
      </form>

      <div class="w:100p border-bottom"></div>

      <form action="products/delete" class="flex flex-col w-full" method="post">
        <table class="n-table n-table-style:striped">
          <thead>
            <tr>
              <th scope="col" class="w:2"></th>
              <th scope="col">상품 이름</th>
              <th scope="col">판매가</th>
              <th scope="col">공급가</th>
              <th scope="col">이미지</th>
              <th scope="col">설명</th>
              <th scope="col">등록일자</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="product: ${list}">
              <td scope="col">
                <input
                  name="deleteId"
                  type="checkbox"
                  class="n-toggle n-toggle-type:check-box n-toggle-size:2"
                  th:value="${product.id}"
                />
              </td>
              <td scope="col" th:text="${product.name}">상품 이름</td>
              <td scope="col" th:text="${product.sellingPrice}">판매가</td>
              <td scope="col" th:text="${product.supplyingPrice}">공급가</td>
              <td scope="col">
                <a href="" th:href="@{/admin/products/{id}(id=${product.id})}">
                  <img id="imgId" th:src="@{'/image/products/'+${product.img}}" alt="첨부이미지" class="w:1"/>
                </a>
              </td>
              <td scope="col" th:text="${product.description}">설명</td>
              <td scope="col" th:text="${#dates.format(product.regDate, 'yyyy년 M월 d일') }">등록일자</td>
            </tr>
          </tbody>
        </table>
        <div class="d:flex jc:end mt:3">
          <div class="mr:3">
            <a href="products/reg" class="n-btn n-btn-size:3"> 등록 </a>
          </div>
          <button class="n-btn n-btn-size:3 n-btn-color:accent mr:3">
            삭제
          </button>
        </div>
      </form>
      <section class="mb:5" >
        <h1 class="d:none">페이저</h1>
        <ul class="n-pager" 
            style="display: flex; justify-content: center;"
            th:with="page = (${param.p} == null)? 1 : ${{param.p}} 
            , floatnum=(${page}-1)/5,
            intnum=${T(java.lang.Math).floor(floatnum)},
            startnum=${intnum}*5+1,
            lastnum = ${count} mod 10 > 0 ? ${count / 10} + 1 : ${count / 10} + 0">
            
              <!-- <li th:text="${T(java.lang.Math).floor(page)}">1</li> -->
          <!-- <li th:text="${startnum}"></li>
          <li th:text="${lastnum}"></li> -->
          <li>
                  <!-- <span th:if="${page} lt 6">이전</span> -->
                  <a th:if="${page} ge 6" href="products?p=1" th:href="@{products?(p=${startnum-1})}">이전</a>
          </li>
              
          <li th:each="n : ${#numbers.sequence(startnum,startnum+4)}"
              th:class = "${{param.p}} eq ${n}? 'active'">
              <a th:if="${n} le ${lastnum}" 
              href="products?p=1"
              th:href="@{./products(p=${n})}"
              th:text="${n}"
              >1</a>
              <!-- 데이터 없는 페이지 넘버 -->
              <!-- <span th:if="${n} gt ${lastnum}" 
              th:text="${n}">1</span> -->
          </li>
          <li>
              <!-- <span th:if="${startnum+5} gt ${lastnum}">다음</span> -->
              <a th:if="${startnum+5} le ${lastnum}"
              href="products?p=12" 
              th:href="@{products?(p=${startnum}+5)}">다음</a>
          </li>
        </ul>
      </section>
    </main>
  </body>
</html>
